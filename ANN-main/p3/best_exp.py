import math
import random
import numpy as np
from typing import List

def modelo(x):
    return 2 * math.exp(0.3*x) + 4 * random.random()


x = [0.0245, 0.1043, 0.1291, 0.1887, 0.2674, 0.323, 0.3645, 0.429, 0.4762, 0.5211, 0.5938, 0.6004, 0.6583, 0.7418, 0.7709, 0.8467, 0.9136, 0.9317, 1.0171, 1.0824, 1.0972, 1.1714, 1.2347, 1.2846, 1.335, 1.3948, 1.4653, 1.5231, 1.5529, 1.6156, 1.6558, 1.712, 1.7694, 1.805, 1.8935, 1.937, 1.9902, 2.0722, 2.1083, 2.1312, 2.1852, 2.2568, 2.3153, 2.3725, 2.4521, 2.4733, 2.5259, 2.6161, 2.636, 2.6856, 2.7465, 2.8322, 2.8879, 2.9139, 2.9869]
y = [2.8011, 2.2045, 4.5814, 2.8417, 3.1022, 3.1338, 3.8886, 3.8039, 3.5191, 3.7951, 3.9649, 3.7547, 4.2641, 4.4348, 4.3489, 4.383, 4.1164, 4.6751, 5.2453, 5.1485, 5.7358, 5.6705, 6.0755, 5.5704, 6.2743, 7.414, 7.5748, 7.6628, 7.3605, 7.6352, 8.8114, 8.5179, 8.8259, 8.9388, 9.4914, 9.8292, 10.0824, 10.5475, 11.0829, 10.2503, 11.89, 11.4345, 12.7644, 12.3186, 13.7983, 13.9851, 14.158, 14.8728, 16.1616, 16.9212, 18.0734, 16.6801, 18.7172, 18.8678, 20.0959]




def best_exp(x: List[float], y: List[float]):

    sum_x = sum(x)
    sum_x2 = sum(xi**2 for xi in x)
    A = [[len(x), sum_x],[sum_x, sum_x2 ]]
    y_ = [math.log(yi) for yi in y]
    sum_xy = sum(xi * yi for xi, yi in zip(x, y_))
    B = [sum(y_), sum_xy]
    a0, a1 = np.linalg.solve(A, B)
    a, b = math.exp(a0), a1
    return a, b

a, b =best_exp(x, y)

def bexp(x):
    return a * math.exp(b*x)

t=np.linspace(min(x), max(x), 100)
bexpt = [bexp(i) for i in t]

print(f'a: {a}')
print(f'b: {b}')
